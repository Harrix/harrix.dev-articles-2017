---
date: 2017-06-11
categories:
  - it
  - programming
tags:
  - C++
  - Visual Studio
author: Anton Sergienko
author-email: anton.b.sergienko@gmail.com
license: CC BY 4.0
license-url: https://github.com/Harrix/harrix.dev/blob/main/LICENSE.md
permalink-source: https://github.com/Harrix/harrix.dev-articles-2017/blob/main/data-grid-view-vs/data-grid-view-vs.md
permalink: https://harrix.dev/ru/articles/2017/data-grid-view-vs/
lang: ru
attribution:
  - author: Microsoft Corporation
    author-site: https://www.microsoft.com/
    license: Public domain
    license-url: https://en.wikipedia.org/wiki/Public_domain
    permalink: https://commons.wikimedia.org/wiki/File:Visual_Studio_2017_Logo.svg
    permalink-date: 2019-06-08
    name: Visual Studio 2017 Logo.svg
---

# –í—ã–≤–æ–¥ —Ç–∞–±–ª–∏—Ü—ã –≤—Ä—É—á–Ω—É—é –≤ Visual Studio –≤ CLR –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏

![Featured image](featured-image.svg)

–ö–∞–∫ –≤—ã–≤–µ—Å—Ç–∏ –¥–∞–Ω–Ω—ã–µ –≤ –æ–±—ã—á–Ω–æ–π —Ç–∞–±–ª–∏—Ü–µ.

<details>
<summary>üìñ –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ</summary>

## –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

- [–°–æ–∑–¥–∞–Ω–∏–µ –±–æ–ª–≤–∞–Ω–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](#—Å–æ–∑–¥–∞–Ω–∏–µ-–±–æ–ª–≤–∞–Ω–∫–∏-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è)
- [–†–∞–∑–º–µ—â–∞–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã](#—Ä–∞–∑–º–µ—â–∞–µ–º-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã)
- [–ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É](#–∑–∞–ø–æ–ª–Ω—è–µ–º-—Ç–∞–±–ª–∏—Ü—É)
- [–í—Ç–æ—Ä–æ–π —Å–ø–æ—Å–æ–±](#–≤—Ç–æ—Ä–æ–π-—Å–ø–æ—Å–æ–±)
- [–í—Ç–æ—Ä–æ–π —Å–ø–æ—Å–æ–± —Å —Ü–∏–∫–ª–æ–º](#–≤—Ç–æ—Ä–æ–π-—Å–ø–æ—Å–æ–±-—Å-—Ü–∏–∫–ª–æ–º)

</details>

## –°–æ–∑–¥–∞–Ω–∏–µ –±–æ–ª–≤–∞–Ω–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –≥–æ—Ç–æ–≤–æ–π —Ñ–æ—Ä–º–æ–π.

–ü–æ–¥–≥–æ—Ç–æ–≤—å—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å –≥–æ—Ç–æ–≤–æ–π —Ñ–æ—Ä–º–æ–π. –ü—Ä–æ—á–∏—Ç–∞—Ç—å –æ–± —ç—Ç–æ–º –º–æ–∂–Ω–æ —Ç—É—Ç: [Visual Studio 2017](https://github.com/Harrix/harrix.dev-articles-2017/blob/main/add-2-num-vs-2017-clr/add-2-num-vs-2017-clr.md) | [‚ÜóÔ∏è](https://harrix.dev/ru/articles/2017/add-2-num-vs-2017-clr/), [Visual Studio 2015](https://github.com/Harrix/harrix.dev-articles-2016/blob/main/add-2-num-vs-2015-clr/add-2-num-vs-2015-clr.md) | [‚ÜóÔ∏è](https://harrix.dev/ru/articles/2016/add-2-num-vs-2015-clr/), [Visual Studio 2010](https://github.com/Harrix/harrix.dev-articles-2016/blob/main/add-2-num-vs-2010-clr/add-2-num-vs-2010-clr.md) | [‚ÜóÔ∏è](https://harrix.dev/ru/articles/2016/add-2-num-vs-2010-clr/):

![–§–æ—Ä–º–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è](img/new-form.png)

_–†–∏—Å—É–Ω–æ–∫ 1 ‚Äî –§–æ—Ä–º–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è_

## –†–∞–∑–º–µ—â–∞–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

–†–∞–∑–º–µ—Å—Ç–∏—Ç–µ –Ω–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏ –∫–Ω–æ–ø–∫—É:

![–ö–Ω–æ–ø–∫–∞ –Ω–∞ —Ñ–æ—Ä–º–µ](img/button.png)

_–†–∏—Å—É–Ω–æ–∫ 2 ‚Äî –ö–Ω–æ–ø–∫–∞ –Ω–∞ —Ñ–æ—Ä–º–µ_

–ò —Ä–∞–∑–º–µ—â–∞–µ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç —Ç–∞–±–ª–∏—Ü—ã `DataGridView`. –û –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –º–æ–∂–Ω–æ –ø–æ—á–∏—Ç–∞—Ç—å [—Ç—É—Ç](http://rsdn.org/article/dotnet/DataGridView20.xml):

![–ö–æ–º–ø–æ–Ω–µ–Ω—Ç DataGridView](img/data-grid-view_01.png)

_–†–∏—Å—É–Ω–æ–∫ 3 ‚Äî –ö–æ–º–ø–æ–Ω–µ–Ω—Ç DataGridView_

–†–∞—Å—Ç—è–Ω—É–ª –∫–æ–º–ø–æ–Ω–µ–Ω—Ç:

![–†–∞—Å—Ç—è–Ω—É—Ç—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç DataGridView](img/data-grid-view_02.png)

_–†–∏—Å—É–Ω–æ–∫ 4 ‚Äî –†–∞—Å—Ç—è–Ω—É—Ç—ã–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç DataGridView_

## –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç–∞–±–ª–∏—Ü—É

–ü—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∫–Ω–æ–ø–∫—É –¥–æ–ª–∂–Ω–∞ –¥–æ–±–∞–≤–∏—Ç—å—Å—è —Ç–∞–±–ª–∏—Ü–∞. –î–ª—è —ç—Ç–æ–≥–æ –¥–≤–∞–∂–¥—ã –∫–ª–∏–∫–∞–µ–º –ø–æ –∫–Ω–æ–ø–∫–µ –∏ –≤–≤–æ–¥–∏–º –∫–æ–¥:

```cpp
// –û—á–∏—Å—Ç–∫–∞ —Å—Ç—Ä–æ–∫ –∏ —Å—Ç–æ–ª–±—Ü–æ–≤ —Ç–∞–±–ª–∏—Ü—ã
dataGridView1->Rows->Clear();
dataGridView1->Columns->Clear();

// –°–æ–∑–¥–∞–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤
DataGridViewTextBoxColumn ^firstColumn = gcnew DataGridViewTextBoxColumn();
firstColumn->HeaderText = "‚Ññ";
firstColumn->Name = "‚Ññ";
DataGridViewTextBoxColumn ^secondColumn = gcnew DataGridViewTextBoxColumn();
secondColumn->HeaderText = "–ò–º—è";
secondColumn->Name = "–ò–º—è";
DataGridViewCheckBoxColumn ^thirdColumn = gcnew DataGridViewCheckBoxColumn();
thirdColumn->Name = "–ù–∞–ª–∏—á–∏–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞";
thirdColumn->HeaderText = "–ù–∞–ª–∏—á–∏–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞";

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤
dataGridView1->Columns->Add(firstColumn);
dataGridView1->Columns->Add(secondColumn);
dataGridView1->Columns->Add(thirdColumn);

// –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–ª—è —è—á–µ–µ–∫ –∏ —Å—Ç—Ä–æ–∫–∏ —Ç–∞–±–ª–∏—Ü—ã
DataGridViewCell ^firstCell;
DataGridViewCell ^secondCell;
DataGridViewCell ^thirdCell;
DataGridViewRow ^row;

// –°–æ–∑–¥–∞–Ω–∏–µ —è—á–µ–µ–∫ –¥–ª—è –ø–µ—Ä–≤–æ–π —Å—Ç—Ä–æ–∫–∏
firstCell = gcnew DataGridViewTextBoxCell();
secondCell = gcnew DataGridViewTextBoxCell();
thirdCell = gcnew DataGridViewCheckBoxCell();
row = gcnew DataGridViewRow();
firstCell->Value = "1";
secondCell->Value = "–ì–∞–Ω—Å";
thirdCell->Value = true;
row->Cells->AddRange(firstCell, secondCell, thirdCell);
dataGridView1->Rows->Add(row);

// –°–æ–∑–¥–∞–Ω–∏–µ —è—á–µ–µ–∫ –¥–ª—è –≤—Ç–æ—Ä–æ–π —Å—Ç—Ä–æ–∫–∏
firstCell = gcnew DataGridViewTextBoxCell();
secondCell = gcnew DataGridViewTextBoxCell();
thirdCell = gcnew DataGridViewCheckBoxCell();
row = gcnew DataGridViewRow();
firstCell->Value = "2";
secondCell->Value = "–¢–∏–º–æ—Ñ–µ–π";
thirdCell->Value = false;
row->Cells->AddRange(firstCell, secondCell, thirdCell);
dataGridView1->Rows->Add(row);

// –°–æ–∑–¥–∞–Ω–∏–µ —è—á–µ–µ–∫ –¥–ª—è —Ç—Ä–µ—Ç—å–µ–π —Å—Ç—Ä–æ–∫–∏
firstCell = gcnew DataGridViewTextBoxCell();
secondCell = gcnew DataGridViewTextBoxCell();
thirdCell = gcnew DataGridViewCheckBoxCell();
row = gcnew DataGridViewRow();
firstCell->Value = "3";
secondCell->Value = "–ö–≤–∞–∑–∏–º–æ–¥–æ";
thirdCell->Value = true;
row->Cells->AddRange(firstCell, secondCell, thirdCell);
dataGridView1->Rows->Add(row);
```

–ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –Ω–∞–∂–∞—Ç–∏–∏ –Ω–∞ –∫–Ω–æ–ø–∫—É –ø–æ–ª—É—á–∏–º —Å–ª–µ–¥—É—é—â–µ–µ:

![–ó–∞–ø—É—â–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ](img/result_01.png)

_–†–∏—Å—É–Ω–æ–∫ 5 ‚Äî –ó–∞–ø—É—â–µ–Ω–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ_

![–¢–∞–±–ª–∏—Ü–∞ –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏](img/result_02.png)

_–†–∏—Å—É–Ω–æ–∫ 6 ‚Äî –¢–∞–±–ª–∏—Ü–∞ –ø–æ—Å–ª–µ –Ω–∞–∂–∞—Ç–∏—è –∫–Ω–æ–ø–∫–∏_

–ù–∞–¥–µ—é—Å—å, —á—Ç–æ –æ—á–µ–≤–∏–¥–Ω–æ, —á—Ç–æ —Å–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π —Å—Ç—Ä–æ—á–∫–∏ —Ç–∞–±–ª–∏—Ü—ã –º–æ–∂–Ω–æ –∑–∞–ø–∏—Ö–∞—Ç—å –≤ —Ü–∏–∫–ª.

## –í—Ç–æ—Ä–æ–π —Å–ø–æ—Å–æ–±

–ü—Ä–µ–¥—ã–¥—É—â–∏–π –≤–∞—Ä–∏–∞–Ω—Ç –Ω–µ –æ—á–µ–Ω—å —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω—ã–π, —Ç–∞–∫ –∫–∞–∫ –¥–∞–∂–µ –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ —Ç—Ä–µ—Ö —Å—Ç—Ä–æ–∫ –≤–∏–¥–Ω–æ, –∫–∞–∫ –ø–æ—è–≤–ª—è—é—Ç—Å—è –∑–∞–ø–∏—Å–∏: –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –∫–∞–∂–¥–æ–π –Ω–æ–≤–æ–π —Å—Ç—Ä–æ—á–∫–∏ —Ç–∞–±–ª–∏—Ü–∞ –æ—Ç—Ä–∏—Å–æ–≤—ã–≤–∞–µ—Ç—Å—è –∑–∞–Ω–æ–≤–æ. –ê –ø—Ä–µ–¥—Å—Ç–∞–≤—å—Ç–µ, —á—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏ –∑–∞–ø–∏—Å–µ–π –±—É–¥–µ—Ç –∫—É–¥–∞ –±–æ–ª—å—à–µ?

–õ—É—á—à–µ –∑–∞—Ä–∞–Ω–µ–µ –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å –Ω–µ–≤–∏–¥–∏–º—É—é —Ç–∞–±–ª–∏—Ü—É –¥–∞–Ω–Ω—ã—Ö `DataTable ^table`, –∑–∞–ø–æ–ª–Ω–∏—Ç—å –µ–π —Ç–µ–º, —á—Ç–æ –Ω—É–∂–Ω–æ. –ê –ø–æ—Ç–æ–º –æ–¥–Ω–æ–π —Å—Ç—Ä–æ—á–∫–æ–π `dataGridView1->DataSource = table;` –æ—Ç–æ–±—Ä–∞–∑–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ.

–ö–æ–¥ –∫–ª–∏–∫–∞ –∫–Ω–æ–ø–∫–∏:

```cpp
DataTable ^table; // –ù–µ–≤–∏–¥–∏–º–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö
DataColumn ^column; // –°—Ç–æ–ª–±–µ—Ü —Ç–∞–±–ª–∏—Ü—ã
DataRow ^row; // –°—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã

// –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –¥–∞–Ω–Ω—ã—Ö
table = gcnew DataTable();

// –ù–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤
String^ nameFirstColumn = "‚Ññ";
String^ nameSecondColumn = "–ò–º—è";
String^ nameThirdColumn = "–ù–∞–ª–∏—á–∏–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞";

// –°–æ–∑–¥–∞–Ω–∏–µ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤
column = gcnew DataColumn(nameFirstColumn, Int32::typeid);
table->Columns->Add(column);
column = gcnew DataColumn(nameSecondColumn, String::typeid);
table->Columns->Add(column);
column = gcnew DataColumn(nameThirdColumn, Boolean::typeid);
table->Columns->Add(column);

// –ó–∞–ø–æ–ª–Ω—è–µ–º –ø–µ—Ä–≤—É—é —Å—Ç—Ä–æ—á–∫—É —Ç–∞–±–ª–∏—Ü—ã
row = table->NewRow();
row[nameFirstColumn] = 1;
row[nameSecondColumn] = "–ì–∞–Ω—Å";
row[nameThirdColumn] = true;
table->Rows->Add(row);

// –ó–∞–ø–æ–ª–Ω—è–µ–º –≤—Ç–æ—Ä—É—é —Å—Ç—Ä–æ—á–∫—É —Ç–∞–±–ª–∏—Ü—ã
row = table->NewRow();
row[nameFirstColumn] = 2;
row[nameSecondColumn] = "–¢–∏–º–æ—Ñ–µ–π";
row[nameThirdColumn] = false;
table->Rows->Add(row);

// –ó–∞–ø–æ–ª–Ω—è–µ–º —Ç—Ä–µ—Ç—å—é —Å—Ç—Ä–æ—á–∫—É —Ç–∞–±–ª–∏—Ü—ã
row = table->NewRow();
row[nameFirstColumn] = 3;
row[nameSecondColumn] = "–ö–≤–∞–∑–∏–º–æ–¥–æ";
row[nameThirdColumn] = true;
table->Rows->Add(row);

// –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –≤ –≤–∏–∑—É–∞–ª—å–Ω–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
dataGridView1->DataSource = table;
```

![–†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã](img/result_03.png)

_–†–∏—Å—É–Ω–æ–∫ 7 ‚Äî –†–µ–∑—É–ª—å—Ç–∞—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–∞–º–º—ã_

–¢–∏–ø—ã –∫–æ–ª–æ–Ω–æ–∫ –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –º–æ–∂–Ω–æ –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ [—Å—Å—ã–ª–∫–µ](https://docs.microsoft.com/en-us/dotnet/api/system.data.datacolumn.datatype?redirectedfrom=MSDN&view=netcore-3.1#System_Data_DataColumn_DataType).

## –í—Ç–æ—Ä–æ–π —Å–ø–æ—Å–æ–± —Å —Ü–∏–∫–ª–æ–º

–ü–æ–∫–∞–∂–µ–º –Ω–∞–ø–æ—Å–ª–µ–¥–æ–∫, –∫–∞–∫ —Ç–æ—Ç –∂–µ –∫–æ–¥ –±—É–¥–µ—Ç –≤—ã–≥–ª—è–¥–µ—Ç—å —Å —Ü–∏–∫–ª–æ–º:

```cpp
DataTable ^table; // –ù–µ–≤–∏–¥–∏–º–∞—è —Ç–∞–±–ª–∏—Ü–∞ –¥–∞–Ω–Ω—ã—Ö
DataColumn ^column; // –°—Ç–æ–ª–±–µ—Ü —Ç–∞–±–ª–∏—Ü—ã
DataRow ^row; // –°—Ç—Ä–æ–∫–∞ —Ç–∞–±–ª–∏—Ü—ã

// –°–æ–∑–¥–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –¥–∞–Ω–Ω—ã—Ö
table = gcnew DataTable();

// –ù–∞–∑–≤–∞–Ω–∏—è —Å—Ç–æ–ª–±—Ü–æ–≤
String^ nameFirstColumn = "‚Ññ";
String^ nameSecondColumn = "–ò–º—è";
String^ nameThirdColumn = "–ù–∞–ª–∏—á–∏–µ –≤–µ–ª–æ—Å–∏–ø–µ–¥–∞";

// –°–æ–∑–¥–∞–Ω–∏–µ –∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–æ–ª–±—Ü–æ–≤
column = gcnew DataColumn(nameFirstColumn, Int32::typeid);
table->Columns->Add(column);
column = gcnew DataColumn(nameSecondColumn, String::typeid);
table->Columns->Add(column);
column = gcnew DataColumn(nameThirdColumn, Boolean::typeid);
table->Columns->Add(column);

for (int i = 0; i < 100; i++) {
  // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å—Ç—Ä–æ—á–∫—É —Ç–∞–±–ª–∏—Ü—ã
  row = table->NewRow();
  row[nameFirstColumn] = i;
  row[nameSecondColumn] = " –ò–º—è " + i.ToString();
  row[nameThirdColumn] = i % 2 == 0;
  table->Rows->Add(row);
}

// –û—Ç–æ–±—Ä–∞–∂–∞–µ–º —Ç–∞–±–ª–∏—Ü—É –≤ –≤–∏–∑—É–∞–ª—å–Ω–æ–º –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ
dataGridView1->DataSource = table;
```

![–ö–æ–¥ –∫–ª–∏–∫–∞ –∫–Ω–æ–ø–∫–∏](img/cpp.png)

_–†–∏—Å—É–Ω–æ–∫ 8 ‚Äî –ö–æ–¥ –∫–ª–∏–∫–∞ –∫–Ω–æ–ø–∫–∏_

![–ü—Ä–∏–º–µ—Ä –±–æ–ª—å—à–æ–π —Ç–∞–±–ª–∏—Ü—ã](img/result_04.png)

_–†–∏—Å—É–Ω–æ–∫ 9 ‚Äî –ü—Ä–∏–º–µ—Ä –±–æ–ª—å—à–æ–π —Ç–∞–±–ª–∏—Ü—ã_
